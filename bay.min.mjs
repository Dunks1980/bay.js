const bay=()=>{"use strict";function e(){const e=new CustomEvent("bay_global_event");window.dispatchEvent(e)}function t(){const e=new CustomEvent("bay_route_event");window.dispatchEvent(e)}function n(e){return"string"==typeof e?(H.textContent=e,H.innerHTML.replaceAll('"',"&quot;").replaceAll("'","&#39;")):e}function o(e){const t=document.createElement("textarea");return t.innerHTML=e,t.value}function i(e,t){return new Proxy(e,{get(e,n){if("isProxy"==n)return!0;const o=e[n];return void 0!==o&&null!=o?(o.isProxy||"object"!=typeof o||(e[n]=i(o,t)),e[n]):void 0},set:(e,o,i)=>(e[o]=n(i),t&&t(),!0)})}function a(){window.bay.route.href=window.location.href,window.bay.route.protocol=window.location.protocol,window.bay.route.host=window.location.host,window.bay.route.hostname=window.location.hostname,window.bay.route.port=window.location.port,window.bay.route.path=window.location.pathname,window.bay.route.search=window.location.search,window.bay.route.hash=window.location.hash,window.bay.route.params={};let e=new URLSearchParams(window.location.search);for(let[t,n]of e)window.bay.route.params[t]=n}function r(e){if("function"==typeof crypto.randomUUID)return crypto.randomUUID().replaceAll("-","").substring(0,e);{let t=()=>([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16));return t().replaceAll("-","").substring(0,e)}}function s(e){const t=[..._(e,"[bay]")];t.forEach((e,t)=>{"dsd"===e.getAttribute("bay")&&e.setAttribute("bay",`dsd-${t}`);let n=e.getAttribute("bay");-1===A.indexOf(n)&&A.push(e)}),A.forEach(e=>{-1===T.indexOf(e.getAttribute("bay"))&&c(e),T.push(e.getAttribute("bay"))})}function l(e,t){const n=new DOMParser;let o,i="",a=t.tagName.toLowerCase(),r="export default /*HTML*/`";for(e.startsWith(r)&&(e=e.trim(),e=e.split(r)[1],e=e.substring(0,e.length-2),e=e.replaceAll("\\${","${").replaceAll("\\`","`"));e.indexOf("<style>")>-1;){const t=e.split("<style>")[1].split("</style>")[0];e=e.replaceAll(`<style>${t}</style>`,""),i+=t}e=e.replaceAll(/<!--[\s\S]*?-->/g,""),o=n.parseFromString(e,"text/html"),o&&(customElements.get(a)||f(o,a,h(t),i,!1))}function d(e,t,n){const o=new DOMParser;let i,a,r=n||[];t.indexOf("<style>")>-1&&(a=t.split("<style>")[1].split("</style>")[0]),t=t.replaceAll(/<!--[\s\S]*?-->/g,"").replaceAll(`<style>${a}</style>`,""),i=o.parseFromString(t,"text/html"),i&&(customElements.get(e.toLowerCase())||f(i,e.toLowerCase(),r,a,!0))}function c(e){try{const t=e.getAttribute("bay");if("dsd-"===t.substring(0,4))E=t,e.shadowRoot?l(o(e.shadowRoot.innerHTML),e):l(o(_(e,"template")[0].innerHTML),e);else if("#"===t.substring(0,1)){E=t;const n=_(document,t)[0];if(!n)return void console.error(`Bay cannot find "${t}" selector.`);l(n.innerHTML,e)}else{const n=new XMLHttpRequest;n.open("GET",t),n.setRequestHeader("Content-Type","text/plain"),n.addEventListener("load",t=>{l(t.target.responseText,e)}),n.addEventListener("error",e=>{console.error(e)}),n.send()}}catch(e){console.error(e)}}function h(e){let t=[];const n=e=>{"bay"!==e.name&&"inner-html"!==e.name&&"fouc"!==e.name&&-1===t.indexOf(e.name)&&t.push(e.name)};return[...e.attributes].forEach(e=>n(e)),[..._(document,e.tagName.toLocaleLowerCase())].forEach(e=>{const t=[...e.attributes];t.forEach(e=>n(e))}),[..._(document,"template")].forEach(t=>{[..._(t.content,e.tagName.toLocaleLowerCase())].forEach(e=>{const t=[...e.attributes];t.forEach(e=>n(e))})}),t}function u(e){const t=new DOMParser,n=t.parseFromString(e,"text/html");return n.body}function p(e){return 3===e.nodeType?"text":8===e.nodeType?"comment":e.tagName.toLowerCase()}function b(e){return e.childNodes&&e.childNodes.length>0?null:e.textContent}function w(e,t){const n=[...t.childNodes],o=[...e.childNodes];let i=n.length-o.length;if(i>0)for(;i>0;i--)n[n.length-i].parentNode.removeChild(n[n.length-i]);o.forEach((e,o)=>{if(!n[o])return void t.appendChild(e.cloneNode(!0));if(p(e)!==p(n[o])){try{n[o].parentNode.replaceChild(e.cloneNode(!0),n[o])}catch(e){}return}const i=b(e);if(i&&i!==b(n[o])&&(n[o].textContent=i),n[o].childNodes.length>0&&e.childNodes.length<1)n[o].innerHTML="";else{if(n[o].childNodes.length<1&&e.childNodes.length>0){const t=document.createDocumentFragment();return w(e,t),void n[o].appendChild(t)}e.childNodes.length>0&&w(e,n[o])}})}function y(e,t){return void 0!==e[t]&&"object"!=typeof e[t]}function m(e,t){[...t.attributes].forEach(n=>{"style"!==n.name&&(e.hasAttribute(n.name)||(t.removeAttribute(n.nodeName),y(t,n.nodeName)&&delete t[n.nodeName]))}),[...e.attributes].forEach(e=>{t.hasAttribute(e.nodeName)&&t.getAttribute(e.nodeName)===e.value||t.setAttribute(e.nodeName,e.value),y(t,e.nodeName)&&t[e.nodeName]!==e.value&&(t[e.nodeName]=e.value)})}function $(e){for(;e.attributes.length>0;)e.removeAttribute(e.attributes[0].name)}function f(e,t,l,d,c){let h,p,b="",y="",f=!1,A=!1,T=!1;try{const n="*:not(:defined){opacity:0;max-width:0px;max-height:0px}*:not(:defined)*{opacity:0;max-width:0px;max-height:0px}.bay-hide{display:none}";d=n+(d||""),y=e.body,b=t;const o=document.createElement(`${t}-update`);y.appendChild(o),(y.innerHTML.indexOf("$global.")>-1||y.innerHTML.indexOf("$global[")>-1)&&(f=!0),(y.innerHTML.indexOf("$route.")>-1||y.innerHTML.indexOf("$route[")>-1||y.innerHTML.indexOf("</router>")>-1||y.innerHTML.indexOf("</route>")>-1||y.innerHTML.indexOf("$bay.update_route")>-1)&&(A=!0),y.innerHTML.indexOf("</route>")>-1&&(d=(d||"")+"[bay-route]>*{pointer-events:none}"),y.innerHTML.indexOf("</show>")>-1&&bay.create(`show-${q}`,C,["open","transition"]);let i=["dsd","noscript","map","for","if","else-if","else","show","switch","case","default","inner-html","route","router","script"],a="element, index, array",s="";i.forEach(e=>{for(;[..._(y,e)].length>0;){const t=[..._(y,e)];t.forEach(t=>{const n=_(t,e)[0];if(!n){const n=t.getAttribute("array")||[],o=t.getAttribute("params")||a,i=t.getAttribute("join")||"",l=t.getAttribute("duration")||!1,d=[...t.attributes][0]?[...t.attributes][0].nodeValue:"",c=t.nextElementSibling?t.nextElementSibling.tagName.toLowerCase():"";let h="` } return '' })() }";const u=t.hasAttribute("break")?"break;":"",p=0===t.innerHTML.length,b=t.attributes.length?t.attributes[0].name:"",w=`<${e}>`,m=`</${e}>`,f=[...t.attributes];$(t);let g=t.outerHTML;switch(e){case"dsd":t.remove();break;case"noscript":y.innerHTML=y.innerHTML.replaceAll(w,"").replaceAll(m,"");break;case"map":g=g.replace(w,`\${ ${n}.${e}((${o}) => { return \``).replace(m,`\`}).join('${i}')}`),t.outerHTML=g;break;case"for":const a=`bay_${e}_${r(8)}`;g=n.length?g.replace(w,`\${(() => { let ${a} = ''; ${n}.forEach((${o}) => { ${a} += \``).replace(m,`\`}); return ${a}; })() }`):g.replace(w,`\${(() => { let ${a} = ''; ${e} (${d}) { ${a} += \``).replace(m,`\`}; return ${a}; })() }`),t.outerHTML=g;break;case"if":"else-if"!==c&&"else"!==c||(h="` }"),t.outerHTML=g.replace(w,`\${(() => { ${e} (${d}) { return \``).replace(m,h);break;case"else-if":"else-if"!==c&&"else"!==c||(h="` }"),t.outerHTML=g.replace(w,` else if (${d}) { return \``).replace(m,h);break;case"else":t.outerHTML=g.replace(w,` ${e} { return \``).replace(m,h);break;case"show":t.outerHTML=l?g.replace(w,`<show-${q} class="bay-show" open="\${${d}}" transition="${l} ease-in-out">`).replace(m,`</show-${q}>`):g.replace(w,`<div class="\${(${d}) ? 'bay-show' : 'bay-show bay-hide'}">`).replace(m,"</div>");break;case"switch":t.outerHTML=g.replace(w,`\${(() => { ${e} (${d}) { `).replace(m," }; return '' })() }");break;case"case":t.outerHTML=p?g.replace(w,`${e} ${d}:`).replace(m," "+u):g.replace(w,`${e} ${d}: return \``).replace(m,"`; "+u);break;case"default":t.outerHTML=g.replace(w,`${e}: return \``).replace(m,"`;");break;case"inner-html":T=!0,t.outerHTML=g.replace(w,"${ (() => { $bay_inner_html += `").replace(m,"`; return ''} )()}"),t.remove();break;case"route":let $="";f.forEach(e=>{$+=` ${e.name}="${e.value}"`}),t.outerHTML=g.replace(w,`<a bay-route :click="e.preventDefault();history.pushState({},'',e.target.getAttribute('href'));window.bay.update_route();"${$}>`).replace(m,"</a>");break;case"router":t.outerHTML=g.replace(w,`\${(() => { let $path = window.bay.router(window.bay.route.path,'${d}'); if ($path) { return \``).replace(m,h);break;case"script":switch(b){case"update":g=g.replace(w,"${/*update*/ (() => {setTimeout(() => {").replace(m,"}, 0); return ``})()}");break;case"props":g=g.replace(w,"${ /*props updates*/ (() => {$props = () => {").replace(m,"};return ``})()}");break;case"render":g=g.replace(w,"${ /*render*/ (() => {").replace(m," return ``})()}");break;case"slotchange":g=g.replace(w,"${ /*slotchange updates*/ (() => {$slotchange = (e) => { $details = e.detail;\n").replace(m,"};return ``})()}");break;case"mounted":s+=`$bay['$mounted'] = () => {${t.innerText}};`,t.remove();break;default:s+=_(y,e)[0].innerText,t.remove()}t&&t.parentNode&&(t.outerHTML=g,t.remove())}}})}}),h=s,p=l}catch(e){console.error(e)}if(!b)return window.top.document.title="ðŸ”´"+E,void console.error("Something went wrong loading file "+E+".");customElements.define(b,class extends HTMLElement{constructor(){super(),this.mounted=!1,this.original_template=`${y.innerHTML}`,this.uniqid=r(8),this.CSP_errors=!1,this.dsd=!1,this.debouncer=!1,this.blob_prefixes="",this.blob_event_prefixes="";const e=this.getAttribute("inner-html");if(e?_(document,e)[0]?this.inner_html_target=_(document,e)[0]:console.error("inner-html target "+e+" not found."):this.inner_html_target=this,document.addEventListener("securitypolicyviolation",e=>{e.preventDefault(),e.violatedDirective.indexOf("script-src")>-1&&"blob"===e.blockedURI&&(console.warn("blob: needed in script-src CSP"),this.CSP_errors=!0),e.violatedDirective.indexOf("style-src")>-1&&"blob"===e.blockedURI&&(console.warn("blob: needed in style-src CSP"),this.CSP_errors=!0)}),this.shadowRoot){const e=[...this.shadowRoot.children],t=document.createElement("div");t.id="bay",e.map(e=>t.appendChild(e)),this.shadowRoot.appendChild(t),this.dsd=!0}else{this.attachShadow({mode:"open"});let e=document.createElement("template");e.innerHTML='<div id="bay"></div>',this.shadowRoot.appendChild(e.content.cloneNode(!0))}this.shadowRoot.proxy=i({},()=>{this.render_debouncer()}),this.shadowRootHTML=_(this.shadowRoot,"#bay")[0],window.bay[this.uniqid]=this.shadowRoot,[...l].forEach(e=>{this.shadowRoot.proxy[e.att]=e.value}),window.bay[this.uniqid][x]=this,this.oldEvents="",h||(h="/* No script tag found */"),this.shadowRoot.uniqid=this.uniqid;let t=this.getRootNode(),s="",c="",u="";t.host&&(s="const $parent = window.bay[parent_uniqid]['proxy'];\n",c=`const $parent = window.bay['${t.host.uniqid}']['proxy'];\n`,u=t.host.uniqid);const p=`const ${g} = window.bay[bay_uniqid];\n`,b=`const ${g} = window.bay['${this.uniqid}'];\n`,w=`const ${v} = window.bay.global;\n`,m=`const ${L} = window.bay.route;\n`,$=`const ${x} = ${g}['${x}'];\n`;this.local_update_evt=new CustomEvent(`bay_local_update_event_${this.uniqid}`);let f="";this.original_template.indexOf("/*props updates*/")>-1&&(f="let $props;\nwindow.addEventListener(`bay_local_update_event_${bay_uniqid}`, () => $props());\n");let E="";this.original_template.indexOf("/*slotchange updates*/")>-1&&(f="let $slotchange = () => {};\nlet $details = {'element': '', 'changed': ''};\nwindow.addEventListener(`bay_slotchange_event_${bay_uniqid}`, (e) => $slotchange(e));\n"),window.bay.decode=o;const M="$bay.decode = window.bay.decode;\n";window.bay.encode=n;const H="$bay.encode = window.bay.encode;\n";window.bay.update_route=a;let R="";A&&(R="$bay.update_route = window.bay.update_route;\n"),window.bay[this.uniqid].addEventListener("slotchange",e=>{this.local_slotchange_evt=new CustomEvent(`bay_slotchange_event_${this.uniqid}`,{detail:{element:e.target,changed:"slotchange"}}),window.dispatchEvent(this.local_slotchange_evt)});let S=_(this,"*");S.forEach(e=>{const t=new MutationObserver(t=>{t.forEach(t=>{"attributes"===t.type?(this.local_slotchange_evt=new CustomEvent(`bay_slotchange_event_${this.uniqid}`,{detail:{element:e,changed:"attributes"}}),window.dispatchEvent(this.local_slotchange_evt)):"childList"===t.type&&(this.local_slotchange_evt=new CustomEvent(`bay_slotchange_event_${this.uniqid}`,{detail:{element:e,changed:"childList"}}),window.dispatchEvent(this.local_slotchange_evt))})});t.observe(e,{attributes:!0,childList:!0})});let q="",C="",k="";T&&(q="let $bay_inner_html = '';\n",C=" $bay_inner_html = ''; ",k="\n$bay.inner_html = () => { return $bay_inner_html; };"),this.blob_prefixes=`${p}${w}${m}${$}${s}${q}${H}${M}${f}${E}${R}`,this.blob_event_prefixes=`${b}${w}${m}${$}${c}${H}${M}${R}`;let N=`${this.blob_prefixes}`+o(h).replaceAll("this[",`${g}.proxy[`).replaceAll("this.",`${g}.proxy.`).replace(/(^[ \t]*\n)/gm,""),O=o(this.original_template).replaceAll("this[",`${g}.proxy[`).replaceAll("this.",`${g}.proxy.`).replace(/(^[ \t]*\n)/gm,""),U="";if(d&&(U=o(d).replaceAll('"${',"${").replaceAll("'${","${").replaceAll('}"',"}").replaceAll("}'","}").replaceAll("this[",`${g}.proxy[`).replaceAll("this.",`${g}.proxy.`).replaceAll("  ","").replaceAll("\n","")),this.add_JS_BlobFileToHead(`${N}\n${g}.template = () => {${C}return \`${O}\`;};\n${g}.styles = () => { return \`${U}\`;};${k}`,u),this.hasAdoptedStyleSheets=!1,"adoptedStyleSheets"in document&&(this.hasAdoptedStyleSheets=!0),this.hasAdoptedStyleSheets)this.sheet=new CSSStyleSheet,this.sheet.replaceSync(U),this.shadowRoot.adoptedStyleSheets=[this.sheet];else{const e=new Blob([U],{type:"text/css"});let t=URL.createObjectURL(e),n=document.createElement("link");n.rel="stylesheet",n.href=t,this.shadowRoot.appendChild(n),n.id="bay-style";let o=document.createElement("link");o.id="bay-style-update",o.href=t,o.rel="stylesheet",this.shadowRoot.appendChild(o),this.styleLinkUpdate=o}}add_events_and_styles(e){if(!e)return;let t="";e.forEach((e,n)=>{const o=e.attributes;[...o].forEach(o=>{let i=":"===o.name.substring(0,1);if(i)if(o.name.indexOf(":style")>-1)e.style=o.value;else{let i=o.value.replaceAll("window.bay",`${g}`);-1===t.indexOf(`${g}['${n}'] = {};`)&&(t+=`${g}['${n}'] = {};`),t+=`${g}['${n}']['${o.name}'] = function(e) {${i}};\n`,e[`on${o.name.split(":")[1]}`]=(e=>{window.bay[this.uniqid][`${n}`]&&window.bay[this.uniqid][`${n}`][`${o.name}`]&&window.bay[this.uniqid][`${n}`][o.name](e)})}})}),t&&this.oldEvents!==t&&(this.oldEvents=t,this.add_JS_Blob_event(t))}set_styles(){const e=window.bay[this.uniqid].styles();if(this.oldStyles!==e)if(this.oldStyles=e,this.hasAdoptedStyleSheets)this.sheet.replaceSync(e);else{var t=new Blob([e],{type:"text/css"}),n=URL.createObjectURL(t);this.styleLinkUpdate.href=n,URL.revokeObjectURL(n)}}isEqual_fn(e,t){e.forEach((e,n)=>{const o=t[n].isEqualNode(e);!o&&t[n]&&m(e,t[n]),e.hasAttribute(":style")||e.hasAttribute("style")||t[n].removeAttribute("style")})}render_innerHTML(e){if(!e)return;if("function"!=typeof window.bay[this.uniqid].inner_html)return;window.bay[this.uniqid].template();const t=u(window.bay[this.uniqid].inner_html());w(t,e);const n=[..._(e,"*")],o=[..._(t,"*")];this.isEqual_fn(o,n)}render_shadowDOM(){const e=u(window.bay[this.uniqid].template());w(e,this.shadowRootHTML);const t=[..._(e,"*")],n=[..._(this.shadowRootHTML,"*")];this.isEqual_fn(t,n)}render_debouncer(){this.debouncer&&window.cancelAnimationFrame(this.debouncer),this.debouncer=window.requestAnimationFrame(()=>{this.render()})}render(){if(this.CSP_errors)this.shadowRoot.innerHTML="";else if(this.original_template&&this.shadowRootHTML.innerHTML&&"function"==typeof window.bay[this.uniqid].template)try{T&&this.render_innerHTML(this.inner_html_target),this.render_shadowDOM(),T?this.add_events_and_styles([..._(this.inner_html_target,"*"),..._(this.shadowRootHTML,"*")]):this.add_events_and_styles([..._(this.shadowRootHTML,"*")]),this.set_styles(),!1===this.mounted&&window.bay[this.uniqid].$mounted&&(this.mounted=!0,setTimeout(()=>{window.bay[this.uniqid].$mounted()},14)),_(this.shadowRoot,"[bay]")[0]&&s(this.shadowRoot),this.hasAttribute("fouc")&&this.removeAttribute("fouc")}catch(e){console.error(e)}}async add_JS_Blob_event(e){const t=new Blob([`export default () => {"use strict";\n${this.blob_event_prefixes}${e}};`],{type:"text/javascript"}),n=URL.createObjectURL(t),o=await import(n);o.default(),URL.revokeObjectURL(n)}async add_JS_BlobFileToHead(e,n){if(M[t])await import(M[t]).then(e=>{e.default(this.uniqid,n),this.after_blob_loaded()});else{const o=new Blob([`export default (bay_uniqid, parent_uniqid) => {"use strict";\n${e}};`],{type:"text/javascript"}),i=URL.createObjectURL(o);M[t]=i,await import(i).then(e=>{e.default(this.uniqid,n),this.after_blob_loaded(),c&&URL.revokeObjectURL(i)})}}after_blob_loaded(){this.dsd||(this.original_template=window.bay[this.uniqid].template(),this.shadowRoot.getElementById("bay").innerHTML=this.original_template),this.render_debouncer(),this.CSP_errors?this.shadowRoot.innerHTML="CSP issue, add blob: to script-src & style-src whitelist.":_(this.shadowRoot,"[bay]")[0]&&s(this.shadowRoot)}connectedCallback(){try{f&&window.addEventListener("bay_global_event",e=>{this.render_debouncer()}),A&&window.addEventListener("bay_route_event",e=>{this.render_debouncer()})}catch(e){console.error(e)}}static get observedAttributes(){return p}attributeChangedCallback(e,t,n){t!==n&&(this.shadowRoot.proxy[e]=n,window.dispatchEvent(this.local_update_evt))}})}const _=(e,t)=>e.querySelectorAll(t),g="$bay",v="$global",L="$route",x="$el";window.bay={};let E="",A=[],T=[],M={};(function e(t){_(t,"template[shadowroot]").forEach(t=>{const n=t.getAttribute("shadowroot"),o=t.parentNode.attachShadow({mode:n});o.appendChild(t.content),t.remove(),e(o)})})(document);const H=document.createElement("textarea");let R,S;window.bay.global=i({},()=>{R&&window.cancelAnimationFrame(R),R=window.requestAnimationFrame(()=>{e()})}),window.bay.route=i({},()=>{S&&window.cancelAnimationFrame(S),S=window.requestAnimationFrame(()=>{t()})}),a(),window.addEventListener("popstate",()=>{a()}),window.bay.router=function(e,t){const n=t.split("/"),o=e.split("/");let i=!0,a={};for(let e=0;e<n.length;e++)if(":"===n[e][0])a[n[e].slice(1)]=o[e];else if("*"!==n[e]&&n[e]!==o[e]){i=!1;break}return!!i&&a};const q=r(8),C="\n    <div id=\"show\" :style=\"${this.style()}\"><slot></slot></div>\n    <script update>$bay.getElementById('show').ontransitionend = () => this.end();</script>\n    <script props>this.slide(this.open);</script>\n    <script mounted>this.slide(this.open);</script>\n    <script>\n      this.opacity = 0;\n      this.display = 'none';\n      this.slide = (open) => {\n        let opacity = 0;\n        if (open === 'true') {opacity = 1; this.display = 'block';}\n        requestAnimationFrame(() => {this.opacity = opacity;});};\n      this.end = () => {if (this.open === 'false') { this.display = 'none';}}\n      this.style = () => {return `display:${this.display}; opacity:${this.opacity}; transition: opacity ${this.transition || '0s'};`;};\n    </script>\n  ";window.addEventListener("load",()=>{s(document)}),bay.refresh=(()=>{s(document)}),bay.create=d};export default bay;